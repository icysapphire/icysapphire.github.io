<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
window.color_set=[
  [255, 0, 0],
  [0,255,0],
  [0,0,255],
  [255,255,255]
];
function pausecomp(millis)
{
    var date = new Date();
    var curDate = null;
    do { curDate = new Date(); }
    while(curDate-date < millis);
}
function newColor(old){
  newc = Math.floor(Math.random()*3);
  if (newc==old) return newColor(old);
  else return newc;
}
function generateCode(){
code = new Array();
code[0]=0;
for(i=1; i<5; i++){
  code[i]=newColor(code[i-1]);
}
  code[i]=3;
$('input').val(code.join());
window.code=code;
}

function switchScreen(i){
  $('input').hide();
  $('body').css('background-color','rgb('+window.color_set[window.code[i]][0]+','+window.color_set[window.code[i]][1]+','+window.color_set[window.code[i]][2]+')');
}
  
function broadcastCode(){
  b=500;
for(i=0; i<7; i++){
  //console.log('rgb('+color_set[code[i]][0]+','+color_set[code[i]][1]+','+color_set[code[i]][2]+')');
  setTimeout(switchScreen.bind(null,i), b + i*500);
}
  setTimeout(function(){$('input').val('New code').show();}, b + i*500);
  }</script>
</head>
<body>
<input type="button" value="Generate Code" style="font-size:80px" onclick="generateCode();setTimeout(broadcastCode,600);">
</body>
